module.exports = {

"[project]/.next-internal/server/app/api/signup/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/child_process [external] (child_process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("child_process", () => require("child_process"));

module.exports = mod;
}}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/os [external] (os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}}),
"[externals]/net [external] (net, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}}),
"[externals]/tls [external] (tls, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}}),
"[externals]/assert [external] (assert, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}}),
"[externals]/tty [external] (tty, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tty", () => require("tty"));

module.exports = mod;
}}),
"[externals]/util [external] (util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/punycode [external] (punycode, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("punycode", () => require("punycode"));

module.exports = mod;
}}),
"[externals]/zlib [external] (zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}}),
"[externals]/querystring [external] (querystring, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}}),
"[externals]/crypto [external] (crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}}),
"[externals]/node:events [external] (node:events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}}),
"[externals]/node:process [external] (node:process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:process", () => require("node:process"));

module.exports = mod;
}}),
"[externals]/node:util [external] (node:util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[externals]/buffer [external] (buffer, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}}),
"[externals]/events [external] (events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}}),
"[externals]/http2 [external] (http2, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http2", () => require("http2"));

module.exports = mod;
}}),
"[externals]/process [external] (process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("process", () => require("process"));

module.exports = mod;
}}),
"[project]/src/app/api/signup/route.js [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "POST": (()=>POST)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$googleapis$2f$build$2f$src$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/googleapis/build/src/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$resend$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/resend/dist/index.mjs [app-route] (ecmascript)");
;
;
function formatPhone(phone) {
    const digits = phone.replace(/\D/g, '');
    if (digits.length !== 10) throw new Error('Invalid phone number');
    return `${digits.slice(0, 3)}-${digits.slice(3, 6)}-${digits.slice(6)}`;
}
function generateICS({ eventName, formattedEventDate, name, email }) {
    const now = new Date();
    const eventDate = new Date(formattedEventDate);
    eventDate.setHours(16, 30); // Default start time: 4:30 PM
    const endDate = new Date(eventDate.getTime() + 2 * 60 * 60 * 1000); // +2 hours
    const format = (d)=>d.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
    return `
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//MCMA Kitchen//EN
CALSCALE:GREGORIAN
METHOD:REQUEST
BEGIN:VEVENT
DTSTART:${format(eventDate)}
DTEND:${format(endDate)}
DTSTAMP:${format(now)}
SUMMARY:MCMA Kitchen – ${eventName}
DESCRIPTION:Thanks for volunteering, ${name}!
ORGANIZER;CN=MCMA Kitchen:mailto:${process.env.ADMIN_EMAIL}
ATTENDEE;CN=${name};RSVP=TRUE:mailto:${email}
LOCATION:MCMA Kitchen
UID:${Date.now()}@mcmakitchen.org
STATUS:CONFIRMED
SEQUENCE:0
END:VEVENT
END:VCALENDAR
  `.trim();
}
function getGoogleCalendarURL({ eventName, eventDate, name }) {
    const start = new Date(eventDate);
    start.setHours(16, 30);
    const end = new Date(start.getTime() + 2 * 60 * 60 * 1000);
    const format = (d)=>d.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
    const params = new URLSearchParams({
        action: 'TEMPLATE',
        text: `MCMA Kitchen – ${eventName}`,
        dates: `${format(start)}/${format(end)}`,
        details: `Volunteer sign-up for ${eventName}. Thanks, ${name}!`,
        location: 'MCMA Kitchen'
    });
    return `https://www.google.com/calendar/render?${params.toString()}`;
}
async function POST(req) {
    try {
        const { eventName, eventDate, name, phone, email } = await req.json();
        if (!eventName || !eventDate || !name || !phone || !email) {
            return new Response(JSON.stringify({
                error: 'Missing fields'
            }), {
                status: 400
            });
        }
        const formattedPhone = formatPhone(phone);
        const auth = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$googleapis$2f$build$2f$src$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["google"].auth.JWT(process.env.GOOGLE_CLIENT_EMAIL, null, process.env.GOOGLE_PRIVATE_KEY.replace(/\\n/g, '\n'), [
            'https://www.googleapis.com/auth/spreadsheets'
        ]);
        const sheets = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$googleapis$2f$build$2f$src$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["google"].sheets({
            version: 'v4',
            auth
        });
        const sheetId = process.env.GOOGLE_SHEET_ID;
        const now = new Date();
        const formattedTimestamp = now.toLocaleString('en-US', {
            weekday: 'long',
            month: '2-digit',
            day: '2-digit',
            year: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
        });
        const formattedEventDate = new Date(eventDate).toLocaleDateString('en-US', {
            weekday: 'long',
            month: '2-digit',
            day: '2-digit',
            year: '2-digit'
        });
        const newRow = [
            formattedTimestamp,
            eventName,
            formattedEventDate,
            name,
            formattedPhone,
            email
        ];
        await sheets.spreadsheets.values.append({
            spreadsheetId: sheetId,
            range: 'Volunteer Signups!A:F',
            valueInputOption: 'USER_ENTERED',
            insertDataOption: 'INSERT_ROWS',
            requestBody: {
                values: [
                    newRow
                ]
            }
        });
        const resend = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$resend$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Resend"](process.env.RESEND_API_KEY);
        const from = process.env.EMAIL_FROM;
        const admin = process.env.ADMIN_EMAIL;
        const replyTo = process.env.ADMIN_EMAIL;
        const calendarICS = generateICS({
            eventName,
            formattedEventDate,
            name,
            email
        });
        const googleCalendarLink = getGoogleCalendarURL({
            eventName,
            eventDate,
            name
        });
        const htmlBody = `
<div style="font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:#fff; padding:24px; border-radius:12px; border:1px solid #ddd; max-width:480px; margin:0 auto; font-size:16px; line-height:1.6;">
  <div style="text-align:center; margin-bottom:24px;">
    <img src="https://mcma.vercel.app/media/mcmaLogo.png" alt="MCMA Logo" style="max-width:140px; height:auto;" />
  </div>
  <h2 style="margin-bottom:12px;">Thank you for signing up!</h2>
  <p><strong>Event:</strong> ${eventName}</p>
  <p><strong>Date:</strong> ${formattedEventDate}</p>
  <p><strong>Name:</strong> ${name}</p>
  <p><strong>Phone:</strong> ${formattedPhone}</p>
  <p><strong>Email:</strong> ${email}</p>
  <div style="margin-top:30px; text-align:center;">
    <a href="${googleCalendarLink}" target="_blank" style="text-decoration:none;">
      <button style="background:#4285F4; color:#fff; padding:10px 18px; font-size:15px; border:none; border-radius:6px; margin-right:12px; cursor:pointer;">
        Add to Google Calendar
      </button>
    </a>
    <a href="cid:calendar" download="mcma-volunteer.ics">
      <button style="background:#333; color:#fff; padding:10px 18px; font-size:15px; border:none; border-radius:6px; cursor:pointer;">
        Add to Apple Calendar
      </button>
    </a>
  </div>
</div>
`;
        const plainText = `
Thanks for signing up!

Event: ${eventName}
Date: ${formattedEventDate}
Name: ${name}
Phone: ${formattedPhone}
Email: ${email}
`;
        // ✅ Email to volunteer
        await resend.emails.send({
            from,
            to: email,
            subject: `MCMA Kitchen – Thanks for signing up to help at the ${eventName} ${formattedEventDate}`,
            html: htmlBody,
            text: plainText,
            reply_to: replyTo,
            attachments: [
                {
                    filename: 'mcma-volunteer.ics',
                    content: calendarICS,
                    contentType: 'text/calendar',
                    contentDisposition: 'inline',
                    cid: 'calendar'
                }
            ]
        });
        // ✅ Email to admin
        await resend.emails.send({
            from,
            to: admin,
            subject: `New MCMA Volunteer Sign-Up: ${name} for ${eventName}`,
            html: htmlBody,
            text: plainText,
            reply_to: replyTo
        });
        return new Response(JSON.stringify({
            status: 'OK',
            submitted: {
                eventName,
                formattedEventDate,
                name,
                formattedPhone,
                email
            }
        }), {
            status: 200
        });
    } catch (err) {
        console.error('❌ Signup form error:', err);
        return new Response(JSON.stringify({
            error: err.message
        }), {
            status: 500
        });
    }
}
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__a56b0004._.js.map